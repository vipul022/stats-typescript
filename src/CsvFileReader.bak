import { readFileSync } from 'fs';
import {dateStringToDate} from "./utils"
import {MatchResult} from "./MatchResult"

// ! resorces: https://nodejs.org/api/fs.html#fs_fs_readfilesync_path_options
 
// !defined a tupple 

type MatchData = [Date, string, string, number, number, MatchResult, string]

export class CsvFileReader {

  data: MatchData[] = [];
// ! it will take filename as argument
  constructor(public filename: string){}

  read(): void {
    this.data = readFileSync(this.filename, {
      // ! encoding: 'utf-8' will return a giant string
      encoding: 'utf-8' 
    })
    // !create an array an split on newline
    .split('\n')
    // !convert each row into an array of strings seprated by ,
    .map((row: string): string[] => {
      return row.split(',')
    })
    // !iterate on each row and change the data types
    .map((row: string[]): MatchData=> {
        return[
          dateStringToDate(row[0]),
          row[1],
          row[2],
          parseInt(row[3]),
          parseInt(row[4]),
          // !this us type assertions where we are explicitly refering row[5] as MatchResult
          row[5] as MatchResult,
          row[6] 
        ]
    })
    
  }
}